function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(){var o,r=document.querySelector(".js-utility-nav"),s=document.querySelector(".nav__mobile-account-options"),c=[],l=[],d=!1,t=!1,u={};null!=sessionStorage.getItem(gcc.brand+":header")?o=JSON.parse(sessionStorage.getItem(gcc.brand+":header")):$.ajax({url:"/api/sitecore/GlobalHeader/GetHeader",async:!1,success:function(e){null!=(e=e.model)&&(o=e,sessionStorage.setItem(gcc.brand+":header",JSON.stringify(e)))}});var m={emailSubScriptionLink:[["href","/forms/newsletter/index?icid=globalheadernewsletter"],["gcc-link-tracker","email-subs-global-header"],["data-analytics-component-name",gcc.globalHeader.analytics.emailComponent],["data-analytics-form-name",gcc.globalHeader.analytics.emailComponent],["data-automation","header:emailsignup"]],signInLink:[["href","#signinmodal"],["gcc-link-tracker","sign-in-global-header"],["data-automation","header:signin"]],myInboxLink:[["href",o.URLmessage],["gcc-link-tracker","mac-my-inbox-global-header"],["data-automation","header:messages"]],viewAccountLink:[["href",o.URLAccount],["gcc-link-tracker","mac-view-account-global-header"],["data-automation","header:viewaccount"]],savedTripsLink:[["href",o.URLSavedTrips],["gcc-link-tracker","mac-my-saved-trips-header"],["data-automation","header:savedtrips"]],myreservationsLink:[["href",o.URLMyReservations],["gcc-link-tracker","mac-my-reservations-trips-header"],["data-automation","header:myreservations"]],mypendingReservationsLink:[["href",o.URLMyPendingReservations],["gcc-link-tracker","mac-my-pending-reservations-trips-header"],["data-automation","header:mypendingreservations"]],travelPlannerLink:[["href",o.URLTravelPlanner],["gcc-link-tracker","mac-travel-planner-global-header"],["data-automation","header:travelplanner"]],signOutLink:[["href","/account/logout?returnUrl="+window.location.pathname+"&forgetMe=false"],["gcc-link-tracker","sign-out-global-header"],["data-automation","header:signout"],["id","globalNavSignout"]],travelCreditsLink:[["href",o.URLCredits],["gcc-link-tracker","mac-my-inbox-global-header"],["data-automation","header:travelcredits"]],MACDropdown:[["data-automation","header:macmenu:toggle"]]};function p(){r.classList.add("initalized")}function v(n,e){e.forEach(function(e){n.setAttribute(e[0],e[1])})}function g(){setTimeout(function(){window.angularUtils.refreshAngular(null,".js-utility-nav"),window.angularUtils.refreshAngular(null,".js-mac-min-utility"),window.angularUtils.refreshAngular(null,".js-mac-signedin-container")},2e3)}function f(e,n,t,i,a){var o=document.createElement("a");null!=i&&i.forEach(function(e){o.classList.add(e)}),o.innerHTML=null===e?n:'<i class="'.concat(e,'"></i> <span>').concat(n,"</span>"),null!=t&&v(o,t),"primary"===a?c.push(o):l.push(o)}function i(){var e=document.querySelector(".popover--sign-in-prompt.fade-in");null==e||d||(e.classList.add("fade-out"),setTimeout(function(){e.removeEventListener("mouseenter",w),e.removeEventListener("mouseleave",T),window.removeEventListener("click",y),e.remove()},600))}function L(){t=!0;var a=document.querySelector(".js-new-message-popover");a.classList.remove("active"),a.removeChild(a.firstChild),a.addEventListener("mouseenter",w),a.addEventListener("mouseleave",T),window.addEventListener("click",y),u.unreadmessages.forEach(function(e,n){var t=document.createElement("a");t.classList.add("mac-message-preview"),t.innerHTML='<span class="preview-message-date">'.concat(u.unreadmessages[n].DateText,'\n            </span><span class="preview-message-subject">').concat(u.unreadmessages[n].Subject,'\n            </span><span class="preview-message-sender">').concat(u.unreadmessages[n].Sender,"</span>");var i="/my-account/my-inbox?msgid=".concat(u.unreadmessages[n].MessageId,"&icid=glblmac_inbxnotifmdl_tl_msgdtls");t.setAttribute("href",i),a.insertBefore(t,a.lastChild)})}function y(){var e=document.querySelector(".popover--sign-in-prompt.fade-in"),n=document.querySelector(".js-new-message-popover.active");d||(null!=e?i():null==n||t?null!=n&&t&&n.classList.remove("active"):(n.classList.remove("active"),L(),t=!0))}function h(){var e=new Date,n=e.getTime();n+=36e5,e.setTime(n),document.cookie="signinpopover=seen; expires="+e.toUTCString()+"; path=/"}function k(e){e.target.classList.contains("popover")||(document.querySelector(".js-utility-nav-mac-dropdown").classList.remove("active"),document.querySelector(".js-mac-popover-menu").classList.remove("active"),window.removeEventListener("click",k))}function w(){d=!0}function T(){d=!1,setTimeout(i,500),setTimeout(y,500)}function b(e,n){var t=document.querySelector(e);switch(n){case"messageCount":t.innerHTML="".concat(t.innerHTML," (").concat(u.unreadmessagecount,")");break;case"creditAmmount":t.lastChild.innerHTML="".concat(t.lastChild.innerHTML," ($").concat(u.credits,")");break;case"savedTripCount":t.lastChild.innerHTML="".concat(t.lastChild.innerHTML," (").concat(u.savedtrips,")");break;case"myreservationsTripCount":t.lastChild.innerHTML="".concat(t.lastChild.innerHTML," (").concat(u.myreservations,")");break;case"mypendingReservationsTripCount":t.lastChild.innerHTML="".concat(t.lastChild.innerHTML," (").concat(u.mypendingreservations,")")}}function e(){var e;-1<document.cookie.indexOf("signinpopover")||-1<window.location.href.indexOf("account/accountpreview")||((e=document.createElement("div")).classList.add("popover","popover--up","popover--sign-in-prompt"),e.innerHTML=o.SignInPopoverContent,r.classList.add("pos-rel"),r.appendChild(e),e.addEventListener("mouseenter",w),e.addEventListener("mouseleave",T),window.addEventListener("click",y),setTimeout(function(){h(),e.classList.add("fade-in"),setTimeout(i,8e3)},4e3))}function a(){var e,n,t,i,a;(e=document.createElement("div")).classList.add("global-header__utility-item","global-header__utility-item--welcome"),e.setAttribute("data-automation","header:welcome"),"OAT"===gcc.brand?e.innerHTML="True"===gcc.profile.IsSehcMember?'<strong class="push-r-10">Welcome, '.concat(gcc.profile.username,"</strong> <span>").concat(o.SEHWelcomeText,"</span>"):"<strong>Welcome, ".concat(gcc.profile.username,"</strong>"):e.innerHTML="True"===gcc.profile.IsInnerCircleMember?'<strong class="push-r-10">Welcome, '.concat(gcc.profile.username,"</strong> <span>").concat(o.InnerCircleWelcomeText,"</span>"):"<strong>Welcome, ".concat(gcc.profile.username,"</strong>"),r.appendChild(e),//create primary links for messages and myaccount toggle
f(null,o.MessagesLinkText,m.myInboxLink,["global-header__utility-item","js-utility-nav-messages"],"primary"),f(o.AccountIcon,o.MyAccountDropDownText,m.MACDropdown,["global-header__utility-item","global-header__utility-item--mac","js-utility-nav-mac-dropdown"],"primary"),//create popover links for mac
f(o.AccountIcon,o.ViewAccountLinkText,m.viewAccountLink,["nav-popover__item"],"popover"),f(o.CreditIcon,o.CreditsLinkLinkText,m.travelCreditsLink,["nav-popover__item","js-utility-credits"],"popover"),f(o.MyReservationsIcon,o.MyReservationsLinkText,m.myreservationsLink,["nav-popover__item","js-utility-nav-my-reservations-trips"],"popover"),f(o.MyPendingReservationsIcon,o.MyPendingReservationsLinkText,m.mypendingReservationsLink,["nav-popover__item","js-utility-nav-my-pending-reservations-trips"],"popover"),f(o.SavedTripsIcon,o.SavedTripsLinkLinkText,m.savedTripsLink,["nav-popover__item","js-utility-nav-saved-trips"],"popover"),f(o.TravelPlannerIcon,o.TravelerPlannerLinkLinkText,m.travelPlannerLink,["nav-popover__item"],"popover"),f(o.SignoutIcon,o.SignoutLinkLinkText,m.signOutLink,["nav-popover__item","js-global-nav-signout"],"popover"),c.forEach(function(e){r.appendChild(e)}),(n=document.createElement("div")).classList.add("popover","popover--up","popover--mac","js-mac-popover-menu"),r.classList.add("pos-rel"),r.appendChild(n),l.forEach(function(e){n.appendChild(e)}),document.querySelector(".js-utility-nav-mac-dropdown").addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),this.classList.contains("active")?(this.classList.remove("active"),n.classList.remove("active"),window.removeEventListener("click",k)):(this.classList.add("active"),n.classList.add("active"),window.addEventListener("click",k))}),window.addEventListener("click",y),function(){var e=document.createElement("p");e.classList.add("font-large"),e.innerHTML="Welcome, ".concat(gcc.profile.username);var n=document.createElement("a");n.classList.add("btn","btn-main-theme","btn-block","fall-sm"),n.innerText=o.ViewAccountLinkText,v(n,m.viewAccountLink);var t=document.createElement("a");t.innerText=o.SignoutLinkLinkText,v(t,m.signOutLink),s.appendChild(e),s.appendChild(n),s.appendChild(t),document.querySelector(".js-sign-in-mobile").addEventListener("click",function(){var e=document.querySelector(".js-mac-toggle");!0===e.checked?e.checked=!1:e.checked=!0})}(),b(".js-utility-nav-messages","messageCount"),b(".js-utility-credits","creditAmmount"),b(".js-utility-nav-saved-trips","savedTripCount"),b(".js-utility-nav-my-reservations-trips","myreservationsTripCount"),b(".js-utility-nav-my-pending-reservations-trips","mypendingReservationsTripCount"),0<u.unreadmessagecount&&((a=document.createElement("div")).classList.add("popover","popover--up","popover--new-messages","js-new-message-popover"),a.innerHTML=o.MessagesPopoverContent.replace("[MESSAGE_COUNT]",u.unreadmessagecount),r.classList.add("pos-rel"),r.appendChild(a),a.addEventListener("mouseenter",w),a.addEventListener("mouseleave",T),window.addEventListener("click",y),null===sessionStorage.getItem("inboxNotification")||-1<window.location.href.indexOf("account")?(sessionStorage.setItem("inboxNotification","seen"),setTimeout(function(){h(),a.classList.add("active"),setTimeout(function(){d||(L(),window.removeEventListener("click",y))},8e3)},4e3)):L(),t=document.querySelector(".js-utility-nav-messages"),i=document.querySelector(".js-new-message-popover"),t.addEventListener("mouseover",function(e){e.stopPropagation(),e.preventDefault(),document.querySelector(".js-mac-popover-menu").classList.contains("active")||i.classList.add("active")}),t.addEventListener("mouseleave",function(e){e.stopPropagation(),e.preventDefault(),setTimeout(function(){d||i.classList.remove("active")},400)})),p(),g()}function n(){f(o.EmailSignUpIcon,o.EmailSignUpLinkText,m.emailSubScriptionLink,["global-header__utility-item"],"primary"),f(o.AccountIcon,o.SignInLinkText,m.signInLink,["global-header__utility-item","js-sign-in-utility"],"primary"),c.forEach(function(e){r.appendChild(e)}),p(),e(),v(document.querySelector(".js-sign-in-mobile"),m.signInLink),g()}function S(){$.ajax({url:"/api/sitecore/GlobalHeader/MyAccountGlobalHeader",async:!0,success:function(e){var n;void 0!==(e=e.model)&&(n=e,u.unreadmessages=n.UnreadMessages,u.unreadmessagecount=n.UnreadMessageCount,u.credits=n.Credits,u.savedtrips=n.SavedTrips,u.myreservations=n.MyReservations,u.mypendingreservations=n.MyPendingReservations,a())}})}new Promise(function(n,t){var i=window.performance.now(),a=window.performance.now(),o=0;!function e(){o<200&&"object"===("undefined"==typeof gcc?"undefined":_typeof(gcc))&&"object"===_typeof(gcc.profile)&&""!=gcc.profile.loggedin?(a=window.performance.now(),appInsights.trackTrace({message:"Execution time of gcc.profile promise resolved: ".concat(a-i," ms")}),n()):o<200?(o++,setTimeout(e,250)):(a=window.performance.now(),appInsights.trackTrace({message:"Execution time of gcc.profile promise never resolved: ".concat(a-i," ms")}),t(new Error("gcc.profile never resolved")))}()}).then(function(){"string"==typeof gcc.profile.loggedin&&gcc.profile.loggedin.includes("auth")?S():n()}).catch(function(e){console.log(e),appInsights.trackException({exception:e})})}();